# 差比数列待定系数法求和

> 高中数学·数列·差比数列

## 发现

在上到“求和的方法”一节时，接触了“错位相减法”，但看似好像没什么用，用到此方法推导的等比数列求和公式已经可以用了。

这时，一种新的数列横空出世——“差比数列”，展示了错位相减法的意义。

## 差比数列

所谓“差比数列”，就是等差数列×等比数列，即 $a_n=(kn+b)q^n$（$q\ne 0$）。
例如经典的 $a_n=nq^n$，我们就可以通过以下方法解出：

$$
\begin{align}
S_n&=\sum_{i=1}^{n}{iq^i}\\
qS_n=\sum_{i=1}^{n}{iq^{i+1}}&=\sum_{i=2}^{n}{(i-1)q^i}+nq^{n+1}\\
(1-q)S_n&=q_1-nq^{n+1}+\sum_{i=2}^{n}{q^i}\\
S_n&=\frac{q_1-nq^n+\frac{1-q^{n-1}}{1-q}q^2}{1-q}
\end{align}
$$

我们不再深入算下去，虽然错位相减的想法巧妙，但计算量确实较大。
而且，题目大多以不含参的数列考察，难道每一次都需要冒着计算错误的风险继续吗？

## 起因

有一天突然想到，
既然等差数列可以设为 $S_n=An^2+Bn$，
等比数列可以设为 $S_n=A(q^n-1)$，
那么差比数列难道就不可以使用待定系数法吗？

于是观察上面求得的式子，发现这些 $1-q$，$q^n$，$q^2$ 都可以视作常数，所以最后剩下的只有三项：$nq^n$ 相关，$q^n$ 相关，和一个常数。$q$ 不管加一次减一次，都无影响。

所以自然地想到：差比数列的求和公式是 $S_n=(An+B)q^n+C$。（可严格证明，但此处略过）

## 改进

但是这，三个参数，需要一个三元一次方程组，计算量并没有减少。
我们需要的是一个简单的方法帮助我们快速做出填空题。
于是，便开始搜寻 $A,B,C$ 之间以及和 $q$ 等的关系，试图找出一点简化空间。

然而，系数过于复杂，网上有很多公式版本，但太冗长，不好背。

这时，灵光乍现：不就是这个 $q$ 烦人吗，那么代入 $n=0$ 不就把它消掉了？
于是我们便得到：

$$
S_0=B+C
$$

但是，$S_0$又是什么？
经过一段时间的思索，得出了结论：对于不分段的数列，其必有$S_0=0$。
详见前面写的文章：[数列S0与分段的关系 - 简书 (jianshu.com)](https://www.jianshu.com/p/cae88d10c495)

差比数列又是一个不分段的数列，所以我们得到了$\fbox{B+C=0}$！！！

## 结论

于是，差比数列的求和公式的待定系数形式便形成了：

$$
S_n=(An+B)q^n-B
$$

其中 $q$ 为等比数列的公比，$A,B$ 为常数。

## 应用

以一道题为例，试求：

$$\sum_{i=1}^{n}{(6i-4)2^{-i}}$$

先代入求得$S_1=1$，$S_2=1+2=3$。

然后用待定系数设$S_n=(An+B)(\frac{1}{2})^n-B$，代入得：

$$
\left\{
\begin{aligned}
\frac{1}{2}A-\frac{1}{2}B&=1\Rightarrow A-B=2\\
\frac{1}{2}A-\frac{3}{4}B&=3\Rightarrow 2A-3B=12\\
\end{aligned}
\right.
$$

解得

$$
\left\{
\begin{aligned}
A&=-6\\
B&=-8
\end{aligned}
\right.
$$

因此，$S_n=(-6n-8)(\frac{1}{2})^n+8$，经检验成立。

由此可见，计算确实简便了很多。
