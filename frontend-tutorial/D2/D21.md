# D21. é«˜çº§ç±»å‹æ“ä½œ

## 1.1. ğŸŒŸ **Partial å’Œ Requiredï¼šå¯é€‰æ€§é­”æ³•è½¬æ¢å™¨**

### 1.1.1. Partialï¼šè®©å±æ€§å…¨éƒ¨å¯é€‰

**æ ¸å¿ƒæ€æƒ³**ï¼š
Partial æ˜¯ TypeScript çš„å†…ç½®å·¥å…·ç±»å‹ï¼Œå¯å°†å¯¹è±¡ç±»å‹çš„æ‰€æœ‰å±æ€§å˜ä¸º **å¯é€‰å±æ€§**ï¼ˆ`?`ï¼‰ã€‚å®ƒé€‚åˆåœ¨ **éƒ¨åˆ†æ›´æ–°** æˆ– **å¯é€‰å‚æ•°ä¼ é€’** çš„åœºæ™¯ä¸­ä½¿ç”¨ã€‚

**è¯­æ³•ä¸ç¤ºä¾‹**
```typescript
// å®šä¹‰åŸå§‹ç±»å‹
interface User {
  name: string;
  age: number;
  bio: string;
}

// ä½¿ç”¨ Partial å°†æ‰€æœ‰å±æ€§å˜ä¸ºå¯é€‰
type PartialUser = Partial<User>;

// åº”ç”¨åœºæ™¯ï¼šéƒ¨åˆ†æ›´æ–°ç”¨æˆ·ä¿¡æ¯
function updateUser(user: Partial<User>): void {
  console.log(user);
}

// è°ƒç”¨æ—¶å¯åªä¼ é€’éƒ¨åˆ†å±æ€§
updateUser({ name: "Alice" }); // åˆæ³•
updateUser({ age: 30, bio: "Developer" }); // åˆæ³•
```

**å®ç°åŸç†**
```typescript
// Partial çš„æºç å®ç°
type Partial<T> = {
  [P in keyof T]?: T[P]; // éå† T çš„æ‰€æœ‰å±æ€§ï¼Œæ·»åŠ  ?
};
```

:::tip
Partial çš„æ ¸å¿ƒæ˜¯ **æ˜ å°„ç±»å‹ï¼ˆMapped Typesï¼‰**ï¼Œé€šè¿‡ `keyof T` è·å–æ‰€æœ‰å±æ€§ï¼Œå†é€šè¿‡ `?` æ ‡è®°ä¸ºå¯é€‰ã€‚
:::

:::warning
å¦‚æœåŸå§‹ç±»å‹ä¸­æœ‰ `?` å¯é€‰å±æ€§ï¼ŒPartial ä¼šä¿ç•™å…¶å¯é€‰æ€§ã€‚ä¾‹å¦‚ï¼š
```typescript
interface User {
  name: string;
  age?: number; // åŸå§‹å±æ€§å·²å¯é€‰
}
type PartialUser = Partial<User>; // age ä»ä¸ºå¯é€‰
```
:::

### 1.1.2. Requiredï¼šè®©å±æ€§å…¨éƒ¨å¿…å¡«

**æ ¸å¿ƒæ€æƒ³**ï¼š
Required æ˜¯ Partial çš„é€†æ“ä½œï¼Œå°†å¯¹è±¡ç±»å‹çš„æ‰€æœ‰å±æ€§å˜ä¸º **å¿…å¡«å±æ€§**ï¼ˆç§»é™¤ `?`ï¼‰ã€‚å®ƒé€‚åˆåœ¨ **å¼ºåˆ¶æ ¡éªŒæ•°æ®å®Œæ•´æ€§** çš„åœºæ™¯ä¸­ä½¿ç”¨ã€‚

**è¯­æ³•ä¸ç¤ºä¾‹**
```typescript
// å®šä¹‰åŸå§‹ç±»å‹
interface User {
  name: string;
  age?: number; // åŸå§‹å±æ€§å¯é€‰
}

// ä½¿ç”¨ Required å°†æ‰€æœ‰å±æ€§å˜ä¸ºå¿…å¡«
type RequiredUser = Required<User>;

// åº”ç”¨åœºæ™¯ï¼šç¡®ä¿æ¥å£è¿”å›çš„æ•°æ®å®Œæ•´
const fetchUser = async (): Promise<Required<User>> => {
  // å¿…é¡»è¿”å›åŒ…å« name å’Œ age çš„å¯¹è±¡
  return { name: "Bob", age: 25 };
};
```

**å®ç°åŸç†**
```typescript
// Required çš„æºç å®ç°
type Required<T> = {
  [P in keyof T]-?: T[P]; // éå† T çš„æ‰€æœ‰å±æ€§ï¼Œå¼ºåˆ¶å¿…å¡«ï¼ˆ-?ï¼‰
};
```

:::tip
`-?` æ˜¯ TypeScript çš„ **å¿…éœ€æ€§ä¿®é¥°ç¬¦**ï¼Œç”¨äºå¼ºåˆ¶ç§»é™¤å¯é€‰å±æ€§çš„ `?`ã€‚
:::
:::warning
å¦‚æœåŸå§‹ç±»å‹ä¸­æŸä¸ªå±æ€§æœ¬èº«æ˜¯ **å¿…å¡«çš„**ï¼ŒRequired ä¼šä¿ç•™å…¶å¿…å¡«æ€§ã€‚
:::

### 1.1.3. å®æˆ˜æ¡ˆä¾‹ï¼šè¡¨å•æ›´æ–°åŠŸèƒ½

**åœºæ™¯**ï¼šè®¾è®¡ä¸€ä¸ªç”¨æˆ·è¡¨å•ï¼Œå…è®¸éƒ¨åˆ†æ›´æ–°ä¿¡æ¯ï¼ˆå¦‚ä»…ä¿®æ”¹ `name` æˆ– `bio`ï¼‰ã€‚

```typescript
interface User {
  name: string;
  age: number;
  bio: string;
}

// ä½¿ç”¨ Partial å®ç°éƒ¨åˆ†æ›´æ–°
function updateProfile(profile: Partial<User>): void {
  console.log("æ›´æ–°çš„å±æ€§ï¼š", profile);
}

// è°ƒç”¨ç¤ºä¾‹
updateProfile({ name: "Charlie" }); // åˆæ³•
updateProfile({ bio: "Designer" }); // åˆæ³•
```

## 1.2. ğŸŒŸ **Pick å’Œ Omitï¼šç²¾å‡†è£å‰ªå¯¹è±¡å±æ€§**

### 1.2.1. Pickï¼šé€‰æ‹©æ€§ä¿ç•™å±æ€§

**æ ¸å¿ƒæ€æƒ³**ï¼š
Pick å¯ä»åŸå§‹ç±»å‹ä¸­ **é€‰æ‹©æŒ‡å®šå±æ€§**ï¼Œç”Ÿæˆæ–°ç±»å‹ã€‚å®ƒé€‚åˆåœ¨ **æå–æ ¸å¿ƒå­—æ®µ** æˆ– **ç®€åŒ–æ¥å£** çš„åœºæ™¯ä¸­ä½¿ç”¨ã€‚

**è¯­æ³•ä¸ç¤ºä¾‹**
```typescript
interface User {
  id: number;
  name: string;
  email: string;
  age: number;
  address: string;
}

// åªä¿ç•™ name å’Œ email
type UserInfo = Pick<User, "name" | "email">;

const userCard: UserInfo = {
  name: "Alice",
  email: "alice@example.com",
}; // åˆæ³•ï¼Œaddress ç­‰å±æ€§ä¸å¯ç”¨
```

**å®ç°åŸç†**
```typescript
// Pick çš„æºç å®ç°
type Pick<T, K extends keyof T> = {
  [P in K]: T[P]; // ä»…ä¿ç•™ K ä¸­çš„å±æ€§
};
```

:::tip
K å¿…é¡»æ˜¯åŸå§‹ç±»å‹ T çš„å±æ€§å­é›†ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚
:::

### 1.2.2. Omitï¼šé€‰æ‹©æ€§å‰”é™¤å±æ€§

**æ ¸å¿ƒæ€æƒ³**ï¼š
Omit å¯ä»åŸå§‹ç±»å‹ä¸­ **å‰”é™¤æŒ‡å®šå±æ€§**ï¼Œç”Ÿæˆæ–°ç±»å‹ã€‚å®ƒé€‚åˆåœ¨ **æ’é™¤æ•æ„Ÿå­—æ®µ** æˆ– **ç®€åŒ–æ•°æ®ä¼ è¾“** çš„åœºæ™¯ä¸­ä½¿ç”¨ã€‚

**è¯­æ³•ä¸ç¤ºä¾‹**
```typescript
interface User {
  id: number;
  name: string;
  password: string; // æ•æ„Ÿå­—æ®µ
  email: string;
}

// æ’é™¤ password å’Œ id
type PublicUser = Omit<User, "password" | "id">;

const publicProfile: PublicUser = {
  name: "Bob",
  email: "bob@example.com",
}; // åˆæ³•ï¼Œpassword å’Œ id ä¸å¯ç”¨
```

**å®ç°åŸç†**
```typescript
// Omit çš„æºç å®ç°
type Omit<T, K extends keyof any> = Pick<T, Exclude<keyof T, K>>;
```

:::tip
Omit çš„åº•å±‚å®ç°ä¾èµ– Pick å’Œ Excludeï¼Œé€šè¿‡æ’é™¤ç›®æ ‡å±æ€§åé€‰æ‹©å‰©ä½™å±æ€§ã€‚
:::

### 1.2.3. å®æˆ˜æ¡ˆä¾‹ï¼šç”¨æˆ·èµ„æ–™ç¼–è¾‘åœºæ™¯

**åœºæ™¯**ï¼šè®¾è®¡ç”¨æˆ·èµ„æ–™ç¼–è¾‘é¡µï¼Œå…è®¸ç”¨æˆ·ç¼–è¾‘éƒ¨åˆ†ä¿¡æ¯ï¼ˆå¦‚ä»…ç¼–è¾‘ `name` å’Œ `email`ï¼‰ã€‚

```typescript
interface User {
  id: number;
  name: string;
  email: string;
  password: string;
}

// ä½¿ç”¨ Pick æå–å¯ç¼–è¾‘å­—æ®µ
type EditableUser = Pick<User, "name" | "email">;

function editProfile(profile: EditableUser): void {
  console.log("ç¼–è¾‘çš„å­—æ®µï¼š", profile);
}

// è°ƒç”¨ç¤ºä¾‹
editProfile({ name: "Charlie", email: "charlie@example.com" }); // åˆæ³•
```

## 1.3. ğŸŒŸ **typeof å’Œ interfaceï¼šä»å®ä¾‹åˆ°ç±»å‹**

### 1.3.1. typeof çš„åŸºæœ¬ç”¨æ³•

**æ ¸å¿ƒæ€æƒ³**ï¼š
`typeof` å¯ç›´æ¥è·å–å˜é‡çš„ç±»å‹ï¼Œé€‚åˆä» **å…·ä½“å®ä¾‹æ¨å¯¼ç±»å‹**ï¼Œé¿å…æ‰‹åŠ¨é‡å¤å®šä¹‰ã€‚

**è¯­æ³•ä¸ç¤ºä¾‹**
```typescript
// å®šä¹‰å®ä¾‹å¯¹è±¡
const config = {
  host: "localhost",
  port: 3000,
  timeout: 5000,
};

// é€šè¿‡ typeof è·å–ç±»å‹
type ConfigType = typeof config;

// ä½¿ç”¨ç±»å‹
const newConfig: ConfigType = { ...config }; // åˆæ³•
```

:::tip
`typeof` çš„ç±»å‹ä¼šç²¾ç¡®åŒ¹é…å®ä¾‹çš„ç»“æ„ï¼ŒåŒ…æ‹¬å±æ€§ç±»å‹å’Œå¯é€‰æ€§ã€‚
:::

### 1.3.2. typeof ä¸ interface çš„ç»“åˆ

**æ ¸å¿ƒæ€æƒ³**ï¼š
ç»“åˆ `typeof` å’Œ `interface`ï¼Œå¯çµæ´»æ‰©å±•æˆ–ä¿®æ”¹æ¨å¯¼çš„ç±»å‹ã€‚

**è¯­æ³•ä¸ç¤ºä¾‹**
```typescript
const baseConfig = {
  host: "localhost",
  port: 3000,
};

type BaseConfigType = typeof baseConfig;

interface ExtendedConfig extends BaseConfigType {
  timeout: number; // æ‰©å±•æ–°å±æ€§
}

const extendedConfig: ExtendedConfig = {
  host: "localhost",
  port: 3000,
  timeout: 5000,
};
```

:::warning
å¦‚æœå®ä¾‹è¢«ä¿®æ”¹ï¼Œ`typeof` è·å–çš„ç±»å‹ä¸ä¼šè‡ªåŠ¨æ›´æ–°ï¼ä¾‹å¦‚ï¼š
```typescript
let config = { name: "Alice" };
type ConfigType = typeof config; // { name: string }

config = { age: 30 }; // âŒ ç±»å‹é”™è¯¯ï¼ç±»å‹ä¸åŒ¹é…
```
:::

### 1.3.3. å‘ä½è­¦ç¤ºï¼šå¯¹è±¡ä¿®æ”¹åçš„ç±»å‹é™·é˜±

**é—®é¢˜**ï¼š
`typeof` çš„ç±»å‹æ˜¯é™æ€çš„ï¼Œè‹¥å®ä¾‹å¯¹è±¡åŠ¨æ€ä¿®æ”¹ï¼Œå¯èƒ½å¯¼è‡´ç±»å‹é”™è¯¯ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
ä½¿ç”¨ **æ¥å£ï¼ˆinterfaceï¼‰** æˆ– **ç±»å‹åˆ«åï¼ˆtypeï¼‰** å®šä¹‰ç±»å‹ï¼Œé¿å…ä¾èµ– `typeof` çš„åŠ¨æ€æ€§ã€‚

```typescript
// ä½¿ç”¨æ¥å£æ›¿ä»£ typeof
interface Config {
  host: string;
  port: number;
}

let config: Config = { host: "localhost", port: 3000 };
config = { host: "remote", port: 8080 }; // åˆæ³•
```

## çŸ¥è¯†å›é¡¾

1. **Partial å’Œ Required**
   - `Partial<T>`ï¼šè®©æ‰€æœ‰å±æ€§å¯é€‰ã€‚
   - `Required<T>`ï¼šè®©æ‰€æœ‰å±æ€§å¿…å¡«ã€‚
2. **Pick å’Œ Omit**
   - `Pick<T, K>`ï¼šä¿ç•™æŒ‡å®šå±æ€§ã€‚
   - `Omit<T, K>`ï¼šå‰”é™¤æŒ‡å®šå±æ€§ã€‚
3. **typeof**
   - é€šè¿‡å®ä¾‹æ¨å¯¼ç±»å‹ï¼Œä½†éœ€æ³¨æ„åŠ¨æ€ä¿®æ”¹çš„é™·é˜±ã€‚

## è¯¾åç»ƒä¹ 

1. ï¼ˆå•é€‰ï¼‰ä»¥ä¸‹å“ªä¸ªå·¥å…·ç±»å‹å¯ä»¥å°† `User` ç±»å‹çš„ `age` å±æ€§å˜ä¸ºå¯é€‰ï¼Ÿ
   A. `Pick<User>`
   B. `Partial<User>`
   C. `Omit<User>`
   D. `Required<User>`

2. ï¼ˆå¡«ç©ºï¼‰ä½¿ç”¨ `Pick` æå– `User` ç±»å‹çš„ `name` å’Œ `email` å±æ€§ï¼Œä»£ç ä¸ºï¼š
   `type UserInfo = Pick<User, ___>;`

3. ï¼ˆç¼–ç ï¼‰å®šä¹‰ä¸€ä¸ª `Config` æ¥å£ï¼ŒåŒ…å« `host`ï¼ˆå¿…å¡«ï¼‰ã€`timeout`ï¼ˆå¯é€‰ï¼‰ã€‚ä½¿ç”¨ `typeof` è·å–ä»¥ä¸‹å¯¹è±¡çš„ç±»å‹ï¼Œå¹¶ç¡®ä¿ç±»å‹æ­£ç¡®ï¼š
   ```typescript
   const config = { host: "localhost", timeout: 5000 };
   ```

## æ‰©å±•é˜…è¯»

- [TypeScript å®˜æ–¹æ–‡æ¡£ - Utility Types](https://www.typescriptlang.org/docs/handbook/utility-types.html)
- [TypeScript ä¸­çš„ Mapped Types æ·±åº¦è§£æ](https://www.typescriptlang.org/docs/handbook/2/mapped-types.html)
