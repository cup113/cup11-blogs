# D33. è·¯ç”± vue-router

## 3.1. ğŸŒ å‰ç«¯è·¯ç”±ä»£æ›¿åç«¯ç®¡ç†å•é¡µé¢åº”ç”¨

> **SPAï¼ˆSingle Page Applicationï¼‰**ï¼šé€šè¿‡å‰ç«¯è·¯ç”±å®ç°é¡µé¢åˆ‡æ¢ï¼Œæ— éœ€åˆ·æ–°é¡µé¢ã€‚Vue Router æ˜¯ Vue çš„è·¯ç”±è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡ URL çš„å˜åŒ–å®ç°ç»„ä»¶åŠ¨æ€åŠ è½½ã€‚

### æ ¸å¿ƒä¼˜åŠ¿
- **æ— ç¼ä½“éªŒ**ï¼šç”¨æˆ·æ— éœ€ç­‰å¾…é¡µé¢åŠ è½½ï¼Œåˆ‡æ¢é€Ÿåº¦æ›´å¿«
- **SEOå‹å¥½**ï¼šé…åˆæœåŠ¡ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰å¯æå‡æœç´¢å¼•æ“æ”¶å½•
- **ç»Ÿä¸€ç®¡ç†**ï¼šè·¯ç”±ä¸ç»„ä»¶è§£è€¦ï¼Œä¾¿äºç»´æŠ¤

```javascript
// ä¼ ç»Ÿåç«¯è·¯ç”± vs å‰ç«¯è·¯ç”±
// åç«¯è·¯ç”±ï¼š/user/123 â†’ æœåŠ¡å™¨è¿”å›æ–° HTML
// å‰ç«¯è·¯ç”±ï¼š/user/123 â†’ é€šè¿‡ Vue Router åŠ è½½ User ç»„ä»¶
```

## 3.2. ğŸ› ï¸ è·¯ç”±çš„å®šä¹‰å‚æ•°ä¸è¯­æ³•

### 3.2.1. é™æ€è·¯ç”±é…ç½®
```javascript
// è·¯ç”±é…ç½®ç¤ºä¾‹
const routes = [
  { path: '/', component: Home },          // é¦–é¡µ
  { path: '/about', component: About },    // å…³äºé¡µé¢
  { path: '/user', component: UserList },  // ç”¨æˆ·åˆ—è¡¨
]
```

### 3.2.2. åŠ¨æ€è·¯ç”±å‚æ•°
```javascript
// é…ç½®åŠ¨æ€è·¯ç”±å‚æ•°
{ 
  path: '/user/:id', 
  component: UserDetails, 
  props: true // å¼€å¯å‚æ•°ä¼ é€’
}

// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨
<template>
  <div>User ID: {{ $route.params.id }}</div>
</template>
```

### 3.2.3. åµŒå¥—è·¯ç”±
```javascript
// é…ç½®çˆ¶å­è·¯ç”±
{
  path: '/user',
  component: User,
  children: [
    { path: 'profile', component: UserProfile }, // /user/profile
    { path: 'orders', component: UserOrders }    // /user/orders
  ]
}
```

### 3.2.4. è·¯ç”±åˆ«åä¸é‡å®šå‘
```javascript
// åˆ«åé…ç½®
{ path: '/home', component: Home, alias: '/main' }

// é‡å®šå‘é…ç½®
{ path: '/old-path', redirect: '/new-path' }
```

## 3.3. ğŸ”Œ è·¯ç”±é›†æˆåœ¨ Vue ä¸­ä½¿ç”¨

### 3.3.1. å®‰è£…ä¸åŸºç¡€é…ç½®
```bash
npm install vue-router@4
```

```javascript
// src/router/index.js
import { createRouter, createWebHistory } from 'vue-router'
import Home from '@/views/Home.vue'

const routes = [
  { path: '/', component: Home }
]

const router = createRouter({
  history: createWebHistory(),
  routes
})

export default router
```

### 3.3.2. åœ¨ Vue ä¸­æŒ‚è½½è·¯ç”±
```javascript
// main.js
import { createApp } from 'vue'
import App from './App.vue'
import router from './router'

const app = createApp(App)
app.use(router)
app.mount('#app')
```

### 3.3.3. è·¯ç”±å¯¼èˆªç»„ä»¶
```html
<!-- ä½¿ç”¨ router-link å®ç°æ— åˆ·æ–°è·³è½¬ -->
<router-link to="/about">About</router-link>

<!-- åŠ¨æ€è·¯ç”±è·³è½¬ -->
<router-link :to="`/user/${userId}`">æŸ¥çœ‹ç”¨æˆ·</router-link>
```

## 3.4. ğŸ”„ è·¯ç”±å’Œè·¯ç”±å¯¹è±¡çš„ä½¿ç”¨åœºæ™¯

### 3.4.1. è·¯ç”±å¯¹è±¡ $route
```javascript
// åœ¨ç»„ä»¶ä¸­è®¿é—®è·¯ç”±ä¿¡æ¯
export default {
  created() {
    console.log(this.$route.path)     // å½“å‰è·¯å¾„
    console.log(this.$route.params)   // åŠ¨æ€å‚æ•°
    console.log(this.$route.query)    // æŸ¥è¯¢å‚æ•°
    console.log(this.$route.meta)     // è·¯ç”±å…ƒä¿¡æ¯
  }
}
```

### 3.4.2. è·¯ç”±å®ä¾‹ $router
```javascript
// ç¨‹åºåŒ–å¯¼èˆª
this.$router.push({ 
  name: 'UserDetails', 
  params: { id: 123 }, 
  query: { sort: 'desc' } 
})

// å‰è¿›/åé€€
this.$router.go(-1) // åé€€ä¸€æ­¥
```

### 3.4.3. è·¯ç”±å®ˆå«ï¼ˆå¯¼èˆªå®ˆå«ï¼‰
#### å…¨å±€å‰ç½®å®ˆå«
```javascript
router.beforeEach((to, from, next) => {
  if (to.meta.requiresAuth && !isAuthenticated) {
    next('/login')
  } else {
    next()
  }
})
```

#### ç»„ä»¶å†…å®ˆå«
```javascript
export default {
  beforeRouteEnter(to, from, next) {
    // åœ¨æ¸²æŸ“å‰éªŒè¯æƒé™
    next(vm => {
      // è®¿é—®ç»„ä»¶å®ä¾‹
    })
  }
}
```

## 3.5. ğŸ’¡ é«˜çº§åŠŸèƒ½æ‰©å±•

### 3.5.1. è·¯ç”±æ‡’åŠ è½½
```javascript
// æŒ‰éœ€åŠ è½½ç»„ä»¶
const UserDetails = () => import('@/views/UserDetails.vue')

const routes = [
  { 
    path: '/user/:id', 
    component: UserDetails 
  }
]
```

### 3.5.2. è·¯ç”±å…ƒä¿¡æ¯
```javascript
// å®šä¹‰å…ƒä¿¡æ¯
{ 
  path: '/admin', 
  component: AdminPanel, 
  meta: { requiresAuth: true } 
}

// å…¨å±€å®ˆå«ä¸­ä½¿ç”¨
router.beforeEach((to, from, next) => {
  if (to.meta.requiresAuth) {
    // éªŒè¯æƒé™
  }
})
```

## çŸ¥è¯†å›é¡¾

1. **æ ¸å¿ƒæ¦‚å¿µ**ï¼š
   - `path`ï¼šè·¯ç”±è·¯å¾„
   - `component`ï¼šå¯¹åº”ç»„ä»¶
   - `params`ï¼šåŠ¨æ€å‚æ•°ï¼ˆè·¯å¾„ä¸­ï¼‰
   - `query`ï¼šæŸ¥è¯¢å‚æ•°ï¼ˆURLå `?key=value`ï¼‰
2. **å…³é”®æ–¹æ³•**ï¼š
   - `$router.push()`ï¼šè·³è½¬æ–°è·¯ç”±
   - `$route.params`ï¼šè·å–åŠ¨æ€å‚æ•°
3. **é«˜çº§ç‰¹æ€§**ï¼š
   - è·¯ç”±å®ˆå«æ§åˆ¶æƒé™
   - æ‡’åŠ è½½ä¼˜åŒ–æ€§èƒ½
   - è·¯ç”±å…ƒä¿¡æ¯ç®¡ç†æ‰©å±•å±æ€§

## è¯¾åç»ƒä¹ 

1. **å•é€‰**ï¼šä»¥ä¸‹å“ªä¸ªå±æ€§ç”¨äºå®šä¹‰è·¯ç”±çš„å…ƒä¿¡æ¯ï¼Ÿ
   - A. `path`
   - B. `meta`
   - C. `component`
   - D. `query`

2. **å¡«ç©º**ï¼šåŠ¨æ€è·¯ç”±å‚æ•°é€šè¿‡______å±æ€§è®¿é—®ã€‚

3. **ç®€ç­”**ï¼šä¸ºä»€ä¹ˆåœ¨ Vue Router ä¸­æ¨èä½¿ç”¨ `router-link` è€Œä¸æ˜¯ `<a>` æ ‡ç­¾ï¼Ÿ

:::details å‚è€ƒç­”æ¡ˆ
1. B
2. `$route.params`
3. `router-link` é¿å…é¡µé¢åˆ·æ–°ï¼Œæä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼›æ”¯æŒè·¯ç”±é«˜äº®å’ŒåŠ¨æ€å‚æ•°ä¼ é€’ã€‚
:::

## æ‰©å±•é˜…è¯»

- [Vue Router å®˜æ–¹æ–‡æ¡£](https://router.vuejs.org/)
- [è·¯ç”±å®ˆå«å®æˆ˜ï¼šæƒé™æ§åˆ¶](https://router.vuejs.org/guide/advanced/navigation-guards.html)
- [è·¯ç”±æ‡’åŠ è½½ä¸ä»£ç åˆ†å‰²](https://router.vuejs.org/guide/advanced/lazy-loading.html)
