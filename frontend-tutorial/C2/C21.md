# C21. Windows 终端命令行

## 1.1. ⭐ 打开终端命令行

> 在 Windows 系统中，终端（命令提示符或 PowerShell）是程序员与计算机直接对话的「黑窗口」。掌握它的打开方式是学习命令行的第一步。

### 📌 快速打开方式：

1. **开始菜单搜索**：点击左下角「开始」→ 输入 `cmd` 或 `PowerShell` → 选择对应应用。
2. **快捷键组合**：按住 `Win+R` → 输入 `cmd` 或 `powershell` → 回车。

::: warning
PowerShell 是新一代终端，功能更强大，但本节默认以 `cmd` 命令提示符为例。两者语法基本兼容。
:::

```cmd
> dir
> echo Hello World
```

### 🔍 终端窗口元素：

- **提示符**：通常显示当前路径（如 `C:\Users\用户名>`）。
- **命令行输入区**：光标闪烁处输入命令。

## 1.2. 🌟 终端基础命令

> 命令行的「词典」——掌握这些基础命令，可以完成文件管理、系统信息查询等操作。

### 常用命令速查表：
| 命令    | 功能描述                   | 示例                                   |
| ------- | -------------------------- | -------------------------------------- |
| `dir`   | 列出当前目录的文件和子目录 | `dir` → 显示当前目录内容               |
| `cd`    | 切换目录                   | `cd Documents` → 进入 Documents 文件夹 |
| `mkdir` | 创建新目录                 | `mkdir Project` → 新建 Project 文件夹  |
| `copy`  | 复制文件                   | `copy file.txt backup.txt` → 复制文件  |
| `del`   | 删除文件                   | `del file.txt` → 删除文件              |
| `exit`  | 退出终端                   | `exit` → 关闭当前窗口                  |

::: info
- 命令区分大小写（如 `dir` 和 `Dir` 效果相同，但 `DEL` 与 `del` 在某些系统可能不同）。
- 使用 `help` 命令查看帮助，如 `help dir`。
:::

## 1.3. ⭐ 命令的解析结构

> 每条命令都像一句「指令句」，包含 **命令词**、**参数** 和 **选项**。

**命令结构公式**：
`命令词 [选项] [参数]`

**示例解析**：
```cmd
dir /w /o:n C:\Windows
```
- **命令词**：`dir`（显示目录内容）
- **选项**：`/w`（宽列表格式）、`/o:n`（按名称排序）
- **参数**：`C:\Windows`（目标路径）

::: details 互动练习
尝试输入以下命令并观察结果：
`copy file.txt file_backup.txt /y`
（`/y` 表示覆盖时不提示确认）
:::

## 1.4. 🌟 环境变量：程序的「知识库」

> 环境变量是系统为程序预设的「信息存储盒」，例如程序运行路径、临时文件位置等。

### 🔑 核心概念：
- **变量名**：如 `PATH`、`TEMP`、`USERPROFILE`。
- **变量值**：存储路径或字符串（如 `PATH` 的值可能是 `C:\Windows\system32;%USERPROFILE%\bin`）。

### 🛠️ 常见环境变量：
| 变量名        | 作用描述                     | 示例值                                   |
| ------------- | ---------------------------- | ---------------------------------------- |
| `PATH`        | 程序搜索可执行文件的路径列表 | `C:\Windows\system32;...`                |
| `USERPROFILE` | 当前用户的主目录路径         | `C:\Users\你的用户名`                    |
| `TEMP`        | 系统临时文件存储路径         | `C:\Users\你的用户名\AppData\Local\Temp` |

::: warning
修改环境变量可能影响系统稳定性，操作前请备份配置！
:::

## 1.5. ⭐ 设置 PATH 环境变量

> 将工具路径加入 `PATH`，可以让命令在任意目录下直接运行（如 Python、Node.js 的安装目录）。

### 🔧 修改步骤（图形界面）：

1. **打开设置**：
   `Win + I` → `系统` → `关于` → `高级系统设置` → `环境变量`。
2. **编辑 `PATH`**：
   在「系统变量」或「用户变量」中找到 `PATH` → 点击「编辑」→ 新增路径（如 `C:\Python39`）。

### 🐧 命令行修改（高级）：

```cmd
:: 查看当前 PATH
echo %PATH%

:: 临时添加路径到当前终端的 PATH
set PATH=C:\Python39;%PATH%

:: 永久修改需通过图形界面或注册表
```

::: tip
修改后需重启终端或执行 `refreshenv`（PowerShell）使生效。
:::

## 1.6. 🌟 批处理文件加速命令行处理

> 批处理文件（`.bat`）是将多个命令写入文本文件，一键执行的「脚本机器人」。

### 📄 批处理文件基础：

1. **创建文件**：
   用记事本新建文件 → 输入命令 → 保存为 `script.bat`（后缀名需手动添加）。
2. **执行方式**：
   双击文件或在终端输入 `script.bat`。

### 💡 示例脚本：

```bat
@echo off  :: 关闭命令回显
echo 开始备份文件...
copy file.txt backup.txt
echo 备份完成！
pause       :: 暂停等待用户按键
```

### 🔄 参数传递：

在脚本中使用 `%1`、`%2` 接收参数：
```bat
:: 重命名文件脚本
ren %1 %2
```
执行方式：
```cmd
rename.bat old.txt new.txt
```

::: warning
- 脚本可能覆盖文件，操作前务必备份！
- 特殊字符（如 `&`）需用 `^` 转义。
:::

## 知识回顾

1. **终端基础操作**：
   - 打开方式：开始菜单搜索或快捷键 `Win+R`。
   - 常用命令：`dir`、`cd`、`mkdir`、`copy`、`del`。
2. **命令结构**：
   `命令词 [选项] [参数]`（如 `copy /y a.txt b.txt`）。
3. **环境变量核心点**：
   - `PATH` 是程序搜索可执行文件的路径列表。
   - 通过系统设置或命令行修改环境变量。
4. **批处理文件**：
   - `.bat` 脚本可批量执行命令，支持参数传递。
   - 使用 `@echo off` 和 `pause` 控制输出与流程。
5. **注意事项**：
   - 命令行操作谨慎使用删除命令（`del`）。
   - 修改环境变量可能影响系统稳定性。

## 课后练习

1. （单选）以下命令中，哪条可以切换到用户主目录？
   - A. `cd %USERPROFILE%`
   - B. `dir C:\Users`
   - C. `mkdir ~`
   - D. `exit`

2. （填空）查看当前路径的命令是 `______`，显示所有环境变量的命令是 `set`。

3. （操作题）尝试在终端中新建一个名为 `myproject` 的文件夹，然后删除它。

4. （思考题）为什么需要将 Python 安装路径加入 `PATH`？请用 1 句话解释。

5. （实践题）编写一个批处理文件，完成以下操作：
   - 复制当前目录的 `report.docx` 到 `backup` 文件夹
   - 显示「操作完成！」提示信息
